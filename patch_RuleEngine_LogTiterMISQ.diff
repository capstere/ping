--- RuleEngine.ps1
+++ RuleEngine.LogTiterMISQ.patched.ps1
@@ -1541,6 +1541,14 @@
 
             $errInfo = Get-ErrorInfo -Row $row -ErrorLut $errLut -DelamPattern $delamPattern
             $dev = Classify-Deviation -Expected $expCall -Observed $obsD.Call
+
+            # Cache Test Result once (used both in output + LogTiter quant rules)
+            $testResultVal = (Get-RowField -Row $row -FieldName 'Test Result')
+
+            # Apply LogTiter QuantSpec rules (MISQUANTITATION -> Major Functional)
+            $qs = Apply-LogTiterQuantSpec -RuleBank $RuleBank -Assay $assay -ControlCode $cc -ObservedCall $obsD.Call -TestResult $testResultVal -CurrentDeviation $dev -ErrInfo $errInfo
+            try { $dev = ($qs.Deviation + '') } catch {}
+            try { $errInfo = $qs.ErrInfo } catch {}
 
             $tokInfo = [pscustomobject]@{ SampleToken=''; BaseToken=''; ActualSuffix=''; SampleNum=''; SampleNumRaw='' }
             if (($sid + '').Trim()) {
@@ -1680,7 +1688,7 @@
                 SampleNumOK      = $sampleNumOk
                 SampleNumWhy     = $sampleNumWhy
                 Status           = (Get-RowField -Row $row -FieldName 'Status')
-                TestResult       = (Get-RowField -Row $row -FieldName 'Test Result')
+                TestResult       = $testResultVal
                 ErrorText        = (Get-RowField -Row $row -FieldName 'Error')
                 MaxPressure      = $errInfo.MaxPressure
                 PressureFlag     = $errInfo.PressureFlag
@@ -2120,6 +2128,7 @@
         'OK'       { return 'OK' }
         'FP'       { return 'Falskt positiv' }
         'FN'       { return 'Falskt negativ' }
+        'MISQ'     { return 'Major Functional' }
         'ERROR'    { return 'Fel' }
         'MISMATCH' { return 'Mismatch' }
         'UNKNOWN'  { return 'Okänt' }
@@ -2166,6 +2175,136 @@
     return ($out -join ', ')
 }
 
+
+# ============================================================================
+# LOGTITER (QuantSpec) - Extraktion + regelapplikation (MISQUANTITATION)
+# ============================================================================
+function Try-ExtractLogTiter {
+    param([AllowEmptyString()][string]$TestResult)
+
+    $t = ($TestResult + '')
+    if (-not $t) { return $null }
+
+    # Matchar: "(log 2.08)" eller "(log 2,08)"
+    $m = [regex]::Match($t, '\(\s*log\s*([0-9]+(?:[.,][0-9]+)?)\s*\)', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+    if (-not $m.Success) { return $null }
+
+    $s = $m.Groups[1].Value.Replace(',', '.')
+    $val = 0.0
+    if ([double]::TryParse($s, [System.Globalization.NumberStyles]::Float, [System.Globalization.CultureInfo]::InvariantCulture, [ref]$val)) {
+        return $val
+    }
+    return $null
+}
+
+function Apply-LogTiterQuantSpec {
+    param(
+        [Parameter(Mandatory)][hashtable]$RuleBank,
+        [Parameter(Mandatory)][string]$Assay,
+        [Parameter(Mandatory)][string]$ControlCode,
+        [Parameter(Mandatory)][string]$ObservedCall,
+        [Parameter(Mandatory)][string]$TestResult,
+        [Parameter(Mandatory)][string]$CurrentDeviation,
+        [Parameter(Mandatory)][object]$ErrInfo
+    )
+
+    # Default: no change
+    $out = @{
+        Deviation = $CurrentDeviation
+        ErrInfo   = $ErrInfo
+    }
+
+    $obs = (($ObservedCall + '')).Trim().ToUpperInvariant()
+    if ($obs -ne 'POS') { return $out }
+
+    if (-not $RuleBank.ContainsKey('QuantSpecRules')) { return $out }
+    $rules = @($RuleBank.QuantSpecRules)
+    if (-not $rules -or $rules.Count -eq 0) { return $out }
+
+    $ass = ($Assay + '')
+    $cc  = ($ControlCode + '').Trim()
+
+    $logVal = Try-ExtractLogTiter -TestResult $TestResult
+    if ($null -eq $logVal) { return $out }
+
+    foreach ($r in $rules) {
+        if ($null -eq $r) { continue }
+        try {
+            $en = ((Get-RowField -Row $r -FieldName 'Enabled') + '').Trim().ToUpperInvariant()
+            if ($en -and $en -ne 'TRUE') { continue }
+
+            $metric = ((Get-RowField -Row $r -FieldName 'Metric') + '').Trim().ToUpperInvariant()
+            if ($metric -ne 'LOGTITER') { continue }
+
+            $rcc = ((Get-RowField -Row $r -FieldName 'ControlCode') + '').Trim()
+            if (-not $rcc) { continue }
+            if ($rcc -ne $cc) { continue }
+
+            $call = ((Get-RowField -Row $r -FieldName 'Call') + '').Trim().ToUpperInvariant()
+            if ($call -and $call -ne 'POS') { continue }
+
+            $ap = ((Get-RowField -Row $r -FieldName 'AssayPattern') + '').Trim()
+            if (-not $ap) { continue }
+
+            $mt = ((Get-RowField -Row $r -FieldName 'MatchType') + '').Trim().ToUpperInvariant()
+            $assayOk = $false
+            if (-not $mt -or $mt -eq 'EQUALS') {
+                $assayOk = ($ass -eq $ap)
+            } elseif ($mt -eq 'WILDCARD') {
+                if ($ap -eq '*') { $assayOk = $true }
+                else {
+                    $rx = '^' + [regex]::Escape($ap).Replace('\*','.*') + '$'
+                    $assayOk = [regex]::IsMatch($ass, $rx, [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+                }
+            } elseif ($mt -eq 'REGEX') {
+                $assayOk = [regex]::IsMatch($ass, $ap, [System.Text.RegularExpressions.RegexOptions]::IgnoreCase)
+            } else {
+                # okänd matchtype -> behandla som equals
+                $assayOk = ($ass -eq $ap)
+            }
+            if (-not $assayOk) { continue }
+
+            $minS = ((Get-RowField -Row $r -FieldName 'Min') + '').Trim()
+            $maxS = ((Get-RowField -Row $r -FieldName 'Max') + '').Trim()
+            if (-not $minS -or -not $maxS) { continue }
+
+            $min = [double]::Parse($minS.Replace(',', '.'), [System.Globalization.CultureInfo]::InvariantCulture)
+            $max = [double]::Parse($maxS.Replace(',', '.'), [System.Globalization.CultureInfo]::InvariantCulture)
+
+            $mode = ((Get-RowField -Row $r -FieldName 'FailMode') + '').Trim().ToUpperInvariant()
+            if (-not $mode) { $mode = 'OUTSIDE' }
+
+            $fail = $false
+            switch ($mode) {
+                'OUTSIDE_OR_EQUAL' { if ($logVal -le $min -or $logVal -ge $max) { $fail = $true } }
+                default            { if ($logVal -lt $min -or $logVal -gt $max) { $fail = $true } }
+            }
+
+            if ($fail) {
+                $out.Deviation = ((Get-RowField -Row $r -FieldName 'OnFailDeviation') + '').Trim()
+                if (-not $out.Deviation) { $out.Deviation = 'MISQ' }
+
+                # Mutera ErrInfo (lokalt objekt) så att rapporten visar MISQUANTITATION i Error Code
+                try { $out.ErrInfo.ErrorCode = ((Get-RowField -Row $r -FieldName 'OnFailErrorCode') + '').Trim() } catch {}
+                if (-not ($out.ErrInfo.ErrorCode + '').Trim()) { try { $out.ErrInfo.ErrorCode = 'MISQUANTITATION' } catch {} }
+
+                try { $out.ErrInfo.ErrorName = ((Get-RowField -Row $r -FieldName 'OnFailErrorName') + '').Trim() } catch {}
+                if (-not ($out.ErrInfo.ErrorName + '').Trim()) { try { $out.ErrInfo.ErrorName = 'Misquantitation (Log titer outside spec)' } catch {} }
+
+                try { $out.ErrInfo.GeneratesRetest = ((Get-RowField -Row $r -FieldName 'OnFailGeneratesRetest') + '').Trim() } catch {}
+                if (-not ($out.ErrInfo.GeneratesRetest + '').Trim()) { try { $out.ErrInfo.GeneratesRetest = 'N/A' } catch {} }
+
+                try { $out.ErrInfo.IsKnownCode = $true } catch {}
+                return $out
+            }
+
+        } catch {
+            continue
+        }
+    }
+
+    return $out
+}
 # Skriv sektionsrubrik med styling
 function Write-SectionHeader {
     param([int]$Row, [string]$Text, [int]$ColSpan = 4)
@@ -2565,6 +2704,10 @@
             $data[$i, 2] = 'Major Functional'
             $data[$i, 1] = 'Falskt negativ'
         }
+        'MISQ' {
+            $data[$i, 2] = 'Major Functional'
+            $data[$i, 1] = ($r.ErrorCode + '')
+        }
         'MISMATCH' {
             $data[$i, 2] = 'Instrument Error'
             $data[$i, 1] = 'Mismatch'
@@ -2687,6 +2830,18 @@
             $errorCodeCell.Style.Font.Color.SetColor($Colors.MajorFg)
             $errorCodeCell.Style.Font.Bold = $true
         }
+        'MISQ' {
+            # Major Functional (MISQ) - Mörkröd bakgrund, vit text
+            $devCell.Style.Fill.PatternType = [OfficeOpenXml.Style.ExcelFillStyle]::Solid
+            $devCell.Style.Fill.BackgroundColor.SetColor($Colors.MajorBg)
+            $devCell.Style.Font.Color.SetColor($Colors.MajorFg)
+            $devCell.Style.Font.Bold = $true
+            # Färgmarkera även Error Code-kolumnen
+            $errorCodeCell.Style.Fill.PatternType = [OfficeOpenXml.Style.ExcelFillStyle]::Solid
+            $errorCodeCell.Style.Fill.BackgroundColor.SetColor($Colors.MajorBg)
+            $errorCodeCell.Style.Font.Color.SetColor($Colors.MajorFg)
+            $errorCodeCell.Style.Font.Bold = $true
+        }
         'ERROR' {
             # Differentiera mellan Minor Functional och Instrument Error
             $disp = ($data[$i, 2] + '')
